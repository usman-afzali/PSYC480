data <- readxl::read_xlsx("Grades1.xlsx", sheet = "test")
data <- readxl::read_xlsx("Grades1.xlsx", sheet = "test")
data
# Select columns 1, 4, and 5
selected_columns <- data[, c(1, 4, 5)]
selected_rows <- selected_columns[8:13, ]
# Select rows 9 to 14 from the selected columns
selected_rows <- data.frame(lapply(selected_rows, as.numeric))
selected_rows
average <- rowSums(selected_rows) / 3
average
# Create the weights column
weights <- c(0.8, 0.8, 0.8, 0.8, 0.4, 0.4)
weighted_average <- average * weights
weighted_average
data$Weighted_Average <- NA
weighted_average_sum <- sum(weighted_average)
data[8:13, "Weighted_Average"] <- weighted_average
data[8:13, c(1, 4, 5)] <- NA
weighted_average_sum <- sum(weighted_average)
print(weighted_average_sum)
library(openxlsx)
write.xlsx(data, "test1.xlsx", sheetName = "presentation", startRow = 1, startCol = 1)
